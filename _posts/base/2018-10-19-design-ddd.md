---
layout:     post
title:      "领域驱动设计"  
subtitle:   ""
author:     Sun Jianjiao
header-img: "img/bg/default-bg.jpg"
catalog: true
tags:
    - 架构设计
---

微服务设计往往会面临**边界如何划定**的问题。领域驱动设计主要关注：从业务领域视角划分领域边界，**构建通用语言进行高效沟通**。通过业务抽象，建立领域模型，维持**业务和代码的一致性**。

DDD不是架构，而是一种架构的设计方法论，它试图分离技术实现的复杂性，并且**围绕业务概念构建领域模型**来控制业务的复杂性，**解决软件难以理解，难以演进的问题**。 DDD不仅可以用于微服务设计，还可以很好的应用于企业中台的设计。

# 基本概念

1. 领域：用来确定业务范围和边界的，也就是边界内要解决的问题。
2. 子域：领域进一步划分为子领域，简称子域。对应更小的问题域，或更小的业务范围。

领域建模和微服务建设的过程和方法基本类似，其核心思想就是**将问题域逐步分解，降低业务理解和系统实现的复杂度**。

子域根据自身重要性和功能属性划分为3个子域：核心域，通用域和支撑域。

- 核心域：决定产品和公司核心竞争力的子域
- 通用域：被多个子域通用功能的子域。比如权限，认证等，没有企业特点。
- 支撑域：不是核心域和通用域，具有企业特性，但不具有通用性。

建立领域模型的时候，我们需要结合公司的战略重点和商业模式，找到核心域，并且重点关注核心域。

通过领域划分，区分不同子域在公司内的不同功能属性和重要性，从而该公司可对不同子域采取不同的资源投入和建设策略。

1. 通用语言：在事件风暴中，通过团队交流达成共识的，能够**简单、清晰、准确描述业务含义和规则**的语言就是通用语言。也就是**团队统一的语言**，解决交流障碍的问题。
2. 限界上下文：限界就是领域的边界，上下文就是语义环境。这个边界**定义了模型使用的范围**。 领域边界就是由边界上下文来定义的。

限界上下文是微服务拆分的主要依据。在领域模型中，如果不考虑技术异构，团队划分等外部因素，一般情况下，一个限界上下文就可以设计为一个微服务。

## 战略设计向战术设计过度

- 实体：领域模型中的实体是多个属性、操作或行为的载体。对应代码模型就是**实体类**，这个类包含了实体的属性和方法。
- 值对象：值对象就是一个集合。包含了用于描述目的，具有整体概念和不可修改的属性。值对象用于保证属性归类的清晰和概念的完整性，避免属性零碎。

实体是看得到、摸得着的实实在在的业务对象，实体具有业务属性，业务行为和业务逻辑。值对象只是若干个属性的集合，只有数据初始化操作和有限的不涉及修改数据的行为，基本不包含业务逻辑。

![实体和值对象](/img/post/base/ddd/entity-value-object.jpg)
